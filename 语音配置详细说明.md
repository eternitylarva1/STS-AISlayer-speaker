# 语音配置详细说明

## 🎵 音量设置说明

### 为什么默认音量是0.8？

**0.8音量（80%）**的选择基于以下考虑：

#### 1. **用户体验平衡**
- **避免过大声**：1.0音量可能过于响亮，影响游戏体验
- **保证可听性**：0.5以下音量可能过小，听不清楚解说
- **适中范围**：0.8在大多数环境下都能提供清晰的听觉体验

#### 2. **技术参考标准**
- **音频工程标准**：专业音频通常建议工作在-6dB到-3dB（约0.5-0.7倍）
- **游戏音效平衡**：语音解说需要与游戏音效、背景音乐平衡
- **系统兼容性**：不同系统的音量控制精度不同，0.8提供较好的兼容性

#### 3. **实际测试结果**
- **环境噪音**：在有轻微环境噪音的情况下，0.8音量足够清晰
- **语音清晰度**：曼波API生成的语音在0.8音量下最清晰
- **用户反馈**：大多数用户认为80%音量最舒适

### 音量调节建议

| 音量范围 | 适用场景 | 效果描述 |
|---------|---------|---------|
| 0.3-0.5 | 夜间/安静环境 | 轻柔，不干扰他人 |
| 0.6-0.8 | 正常游戏环境 | 清晰，与游戏音效平衡 |
| 0.9-1.0 | 嘈杂环境/听力障碍 | 最大音量，可能过于响亮 |

## 🔧 配置选项详解

### 1. **启用语音解说** (`voiceEnabled`)

**功能说明**：控制是否开启语音解说功能

**选项含义**：
- ✅ **勾选**：启用语音解说，AI解说会自动播放语音
- ❌ **不勾选**：禁用语音解说，只显示文字解说

**使用建议**：
- 初次使用建议先勾选体验
- 如果网络不稳定或音频播放有问题，可以暂时关闭
- 在需要安静环境的场合可以关闭

### 2. **语音音量** (`voiceVolume`)

**功能说明**：控制语音解说的播放音量

**参数范围**：0.0 - 1.0

**数值含义**：
- `0.0` = 静音（无声音）
- `0.5` = 50%音量
- `0.8` = 80%音量（默认推荐）
- `1.0` = 100%音量（最大音量）

**技术细节**：
```java
// 音量控制实现
FloatControl volumeControl = (FloatControl) clip.getControl(FloatControl.Type.MASTER_GAIN);
float min = volumeControl.getMinimum();
float max = volumeControl.getMaximum();
float range = max - min;
float gain = (range * voiceVolume) + min;
volumeControl.setValue(gain);
```

**注意事项**：
- 只在使用Java Sound API时有效
- 使用系统播放器时需要手动调节系统音量
- 建议根据环境噪音和个人喜好调节

### 3. **自动清理语音缓存** (`autoClearVoiceCache`)

**功能说明**：控制是否自动清理已下载的语音文件

**选项含义**：
- ✅ **勾选**：每次游戏启动时自动清理缓存
- ❌ **不勾选**：保留语音文件，避免重复下载

**缓存机制**：
```java
// 缓存文件命名规则
String fileName = "voice_" + text.hashCode() + "_" + voiceId + ".mp3";
// 缓存目录
File cacheDir = new File("voice_cache");
```

**存储空间考虑**：
- 每个语音文件约50-200KB
- 1000条解说约占用50-200MB空间
- 建议定期清理或根据磁盘空间决定

**使用建议**：
- **磁盘空间充足**：不勾选，提升响应速度
- **磁盘空间紧张**：勾选，节省存储空间
- **网络速度快**：可以勾选，每次重新下载
- **网络速度慢**：不勾选，利用缓存

## 🎮 最佳配置推荐

### 配置方案1：标准体验
```json
{
  "voiceEnabled": true,
  "voiceVolume": 0.8,
  "autoClearVoiceCache": false
}
```
**适用**：大多数用户的日常使用

### 配置方案2：安静环境
```json
{
  "voiceEnabled": true,
  "voiceVolume": 0.5,
  "autoClearVoiceCache": true
}
```
**适用**：夜间或需要保持安静的场合

### 配置方案3：性能优先
```json
{
  "voiceEnabled": true,
  "voiceVolume": 0.9,
  "autoClearVoiceCache": false
}
```
**适用**：网络较慢但需要快速响应

### 配置方案4：节省空间
```json
{
  "voiceEnabled": false,
  "voiceVolume": 0.8,
  "autoClearVoiceCache": true
}
```
**适用**：磁盘空间紧张或只需要文字解说

## 🔍 故障排除

### 音量问题
1. **音量调节无效**
   - 检查是否使用系统播放器
   - 确认音量值在0.0-1.0范围内
   - 重启游戏重新加载配置

2. **声音过小或过大**
   - 逐步调节音量值（每次0.1）
   - 检查系统主音量设置
   - 确认游戏音效与语音的平衡

### 缓存问题
1. **重复下载**
   - 检查`autoClearVoiceCache`设置
   - 确认缓存目录权限
   - 手动清理缓存文件夹

2. **磁盘空间不足**
   - 启用自动清理缓存
   - 手动删除voice_cache文件夹
   - 调整解说频率减少生成量

## 📊 性能影响

### 音量控制性能
- **Java Sound API**：实时调节，CPU占用低
- **系统播放器**：依赖系统，无额外性能开销

### 缓存策略性能
- **启用缓存**：首次下载后响应极快
- **禁用缓存**：每次需要下载，网络延迟影响体验

---

通过合理配置这些选项，你可以获得最佳的语音解说体验！建议根据个人使用环境和偏好进行调整。